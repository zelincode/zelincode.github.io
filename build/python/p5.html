<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><title>python爬虫进阶 - Zelincode</title><meta name="description" content="[TOC]"><meta name="keywords" content="python爬虫进阶 - Zelincode"><script src="/static/js/jquery-3.3.1.min.js"></script><script src="/static/js/vue.min.js"></script><link rel="stylesheet" href="/static/css/normalize.min.css"><link rel="stylesheet" href="/static/css/monaco.css"><link rel="stylesheet" href="/static/css/loading.css"><link rel="stylesheet" href="/static/css/editormd.min.css"><link rel="stylesheet" href="/static/css/style.css"><link rel="stylesheet" href="/static/css/mobile.css"><link rel="stylesheet" href="/static/font-awesome-4.7.0/css/font-awesome.min.css"><link rel="stylesheet" href="/static/css/highlight.default.min.css"><script src="/static/js/highlight.min.js"></script><script>window._CONST={ROOT_PATH:"/"},hljs.initHighlightingOnLoad()</script></head><body><div class="main"><div class="tea-menu"><div class="tea-menu-title"><i class="fa fa-home" aria-hidden="true"></i> <span>Zelincode</span></div><div class="tea-menu-search-warp"><i class="fa fa-search"></i> <input type="text" placeholder="搜索文档" value height="100%"></div><ul class="tea-menu-list"><li><a href="/index.html" title="介绍" class>介绍</a></li><li><a title="Java" class>Java<i class="fa fa-angle-down unfold"></i></a><ul class="unfold"><li><a href="/java/java01.html" title="Java环境配置" class>Java环境配置</a></li><li><a href="/java/java02.html" title="Java基础语法" class>Java基础语法</a></li><li><a href="/java/java03.html" title="Java基础" class>Java基础</a></li></ul></li><li><a title="MySQL" class>MySQL<i class="fa fa-angle-down unfold"></i></a><ul class="unfold"><li><a href="/mysql/1.html" title="MySQL安装概述" class>MySQL安装概述</a></li><li><a href="/mysql/2.html" title="MySQL基础" class>MySQL基础</a></li><li><a href="/mysql/3.html" title="MySQL进阶" class>MySQL进阶</a></li></ul></li><li><a title="Python" class="active">Python<i class="fa fa-angle-down unfold"></i></a><ul class="unfold"><li><a href="/python/p0.html" title="Python入门" class>Python入门</a></li><li><a href="/python/p1.html" title="Python基础" class>Python基础</a></li><li><a href="/python/p2.html" title="python进阶" class>python进阶</a></li><li><a href="/python/p3.html" title="python算法" class>python算法</a></li><li><a title="Python爬虫" class="active">Python爬虫<i class="fa fa-angle-down unfold"></i></a><ul class="unfold"><li><a href="/python/p3.html" title="python爬虫基础" class>python爬虫基础</a></li><li><a href="/python/p5.html" title="python爬虫进阶" class="active">python爬虫进阶</a></li><li><a href="/python/p6.html" title="python反爬虫">python反爬虫</a></li></ul></li><li><a title="Scrapy">Scrapy<i class="fa fa-angle-down unfold"></i></a><ul class="unfold"><li><a href="/python/css.html" title="css选择器">css选择器</a></li></ul></li></ul></li><li><a title="大数据">大数据<i class="fa fa-angle-down unfold"></i></a><ul class="unfold"><li><a href="/Hadoop01.html" title="Hadoop">Hadoop</a></li></ul></li><li><a title="Linux">Linux<i class="fa fa-angle-down unfold"></i></a><ul class="unfold"><li><a href="/linux01.html" title="Linux基础">Linux基础</a></li></ul></li><li><a title="PHP">PHP<i class="fa fa-angle-down unfold"></i></a><ul class="unfold"><li><a href="/PHP01.html" title="php基础">php基础</a></li></ul></li><li><a title="其它">其它<i class="fa fa-angle-down unfold"></i></a><ul class="unfold"><li><a href="/config/structure.html" title="文档目录结构介绍">文档目录结构介绍</a></li><li><a href="/config/main.html" title="主配置文件说明">主配置文件说明</a></li><li><a href="/config/nav.html" title="菜单配置文件说明">菜单配置文件说明</a></li></ul></li></ul><div class="tea-version"><p>version: 0.0.1</p><p>Built with <a href="https://github.com/lisniuse/teadocs" target="_blank">Teadocs</a></p></div></div><div class="tea-content"><div class="tea-nav"><h3 class="top-title" style="font-weight:500;margin:0;font-size:16px"><i class="fa fa-navicon" aria-hidden="true"></i> <span>python爬虫进阶</span></h3></div><div class="tea-container"><article class="markdown-body"><p>[TOC]</p><h3 id="xpath"><a href="#xpath" class="header-anchor">#</a> <span>xpath</span></h3><p>xpath**通过对html页面进行树形解析对页面元素进行分析</p><pre class="prettyprint language-python"><code>import requests
import lxml
headers = {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 "
                      "(KHTML, like Gecko) Chrome/51.0.2704.63 Safari/537.36"
    }
url = "http://go.hao123.com"
res= requests.get(url,headers=headers)
html = lxml.etree.HTML(res.text)
cc = html.xpath("/html/body/div[3]/div/div[4]/div[2]/div[1]/div[1]/a[1]/span[1]/text()")
#text()取文本
price = html.xpath("/html/body/div[3]/div/div[4]/div[2]/div[1]/div[1]/a[1]/@alog-text")
#@取属性
print(cc[0])</code></pre><p><img src="C:\Users\weizelin\AppData\Roaming\Typora\typora-user-images\1562742892432.png" alt="1562742892432"></p><pre class="prettyprint language-python"><code>import requests
import lxml
headers = {
        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 "
                      "(KHTML, like Gecko) Chrome/51.0.2704.63 Safari/537.36"
    }
url = "http://go.hao123.com"
res= requests.get(url,headers=headers)
html = lxml.etree.HTML(res.text)
#先找到特价机票的位置
tejia =html.xpath("//div[@class='tejia-air-wrapper']")

#分割为十个城市的具体内容
tejias =tejia[0].xpath(".//div[@class='tejia-air']")


#对每个城市进行处理
for tj in tejias:
    # 搜索出所有的目的地
    aa = tj.xpath(".//a[@class='flight']")
    for a in aa:
        fromto = a.xpath("./@alog-text")        #起始地点和到达地点
        price = a.xpath(".//span[@class ='tickets-price']/text()")    #价格
        print(fromto,price)</code></pre><h3 id="Beautifulsoup"><a href="#Beautifulsoup" class="header-anchor">#</a> <span>Beautifulsoup</span></h3><p>找属性有两种方法</p><ol><li>soup.a['href']</li><li>soup.a.attrs['href']<br>找文本直接.text</li></ol><p>查找有两个函数，find()和find_all()<br>有两个参数，一个是类别，一个是属性的键值对<br>soup.find('a',{'id':'link2'})</p><p>默认返回的是查找到的第一个内容</p><p>BeautifulSoup也是先将html转化成树型结构，不同与xpath的是它通过标签来筛选内容而非层级。</p></article></div></div><i class="fa fa-arrow-circle-up gotop" aria-hidden="true"></i><div id="menu-mask"></div></div><script src="/static/js/main.js"></script><script src="/static/js/mobile.js"></script>
<script src="/__webscoket__/socket.io.js"></script>
<script src="/__webscoket__/socket.client.js"></script>
</body></html>